---

title: Chapter 7. Ensemble Learning & Random Forests
keywords: fastai
sidebar: home_sidebar


---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 07.Ensembles_RFs.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width: 50%;" file="static/imgs/Hard_voting.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">sklearn</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">VotingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="k">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="k">import</span> <span class="n">SVC</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">log_clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">solver</span><span class="o">=</span><span class="s1">&#39;lbfgs&#39;</span><span class="p">)</span>
<span class="n">rf_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">svm_clf</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="s1">&#39;scale&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="k">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">make_moons</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">noise</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.33</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_val</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_val</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((6700, 2), (6700,), (3300, 2), (3300,))</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">voting_clf</span> <span class="o">=</span> <span class="n">VotingClassifier</span><span class="p">(</span><span class="n">estimators</span><span class="o">=</span><span class="p">[(</span><span class="s1">&#39;lr&#39;</span><span class="p">,</span> <span class="n">log_clf</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;rf&#39;</span><span class="p">,</span> <span class="n">rf_clf</span><span class="p">),</span> <span class="p">(</span><span class="s1">&#39;svc&#39;</span><span class="p">,</span> <span class="n">svm_clf</span><span class="p">)],</span> <span class="n">voting</span><span class="o">=</span><span class="s1">&#39;hard&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">voting_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>VotingClassifier(estimators=[(&#39;lr&#39;, LogisticRegression(C=1.0, class_weight=None, dual=False, fit_intercept=True,
          intercept_scaling=1, max_iter=100, multi_class=&#39;warn&#39;,
          n_jobs=None, penalty=&#39;l2&#39;, random_state=None, solver=&#39;lbfgs&#39;,
          tol=0.0001, verbose=0, warm_start=False)), (&#39;rf&#39;, RandomF...,
  max_iter=-1, probability=False, random_state=None, shrinking=True,
  tol=0.001, verbose=False))],
         flatten_transform=None, n_jobs=None, voting=&#39;hard&#39;, weights=None)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Let's take a look at the performance of each classifier + ensemble method on the validation set:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">accuracy_score</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">clf</span> <span class="ow">in</span> <span class="p">[</span><span class="n">log_clf</span><span class="p">,</span> <span class="n">rf_clf</span><span class="p">,</span> <span class="n">svm_clf</span><span class="p">,</span> <span class="n">voting_clf</span><span class="p">]:</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_hat</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>LogisticRegression 0.8181818181818182
RandomForestClassifier 0.8024242424242424
SVC 0.8324242424242424
VotingClassifier 0.8287878787878787
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>There you have it! The voting classifier slightly outperforms the individual classifiers.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>If all ensemble method learners can estimate class probabilities, you can average their probabilities per class then predict the class with the highest probability.<ul>
<li>This is called <strong>Soft voting</strong>.</li>
<li>It often yields results better than hard voting because it weights confidence.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width: 50%;" file="static/imgs/bagging.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Bagging-&amp;-Pasting-in-Scikit-Learn">Bagging &amp; Pasting in Scikit-Learn<a class="anchor-link" href="#Bagging-&amp;-Pasting-in-Scikit-Learn">&#182;</a></h3><ul>
<li>Let's implement bagging in scikit-learn:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">BaggingClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="k">import</span> <span class="n">DecisionTreeClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bag_clf</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bag_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>BaggingClassifier(base_estimator=DecisionTreeClassifier(class_weight=None, criterion=&#39;gini&#39;, max_depth=None,
            max_features=None, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, presort=False, random_state=None,
            splitter=&#39;best&#39;),
         bootstrap=True, bootstrap_features=False, max_features=1.0,
         max_samples=100, n_estimators=500, n_jobs=-1, oob_score=False,
         random_state=None, verbose=0, warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_hat</span> <span class="o">=</span> <span class="n">bag_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width:66%;" file="static/imgs/dt_bagging.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Out-of-Bag-Evaluation">Out-of-Bag Evaluation<a class="anchor-link" href="#Out-of-Bag-Evaluation">&#182;</a></h3><ul>
<li>With bagging, some instances will be sampled several times for several predictors, while others won't be sampled at all.</li>
<li>Only about 63% of the instances are sampled for each predictor.</li>
<li>The other 37% of instances not sampled are called Out-of-Bag (oob) instances. <ul>
<li>Note that they're not the same 37% for all predictors.</li>
</ul>
</li>
<li>Since the individual predictor never sees the oob samples, it can be evaluated on the oob data without the need for a separate validation set.</li>
<li>You can evaluate the ensemble itself by averaging the oob scores of each predictor.</li>
<li>Let's do this using scikit-learn:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bag_clf</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span><span class="n">DecisionTreeClassifier</span><span class="p">(),</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="mf">0.63</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">oob_score</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bag_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>BaggingClassifier(base_estimator=DecisionTreeClassifier(class_weight=None, criterion=&#39;gini&#39;, max_depth=None,
            max_features=None, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, presort=False, random_state=None,
            splitter=&#39;best&#39;),
         bootstrap=True, bootstrap_features=False, max_features=1.0,
         max_samples=0.63, n_estimators=500, n_jobs=-1, oob_score=True,
         random_state=None, verbose=0, warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bag_clf</span><span class="o">.</span><span class="n">oob_score_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8004477611940298</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's verify this estimation using the validation set:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_hat</span> <span class="o">=</span> <span class="n">bag_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_hat</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8093939393939394</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Close enough!</li>
<li>The oob decision function is also available using scikit-learn's API, since our classifier is a decision tree then the decision function is a ratio that can be expressed as a probability, let's take a look at it for each instance:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bag_clf</span><span class="o">.</span><span class="n">oob_decision_function_</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[0.44839858, 0.55160142],
       [0.01858736, 0.98141264],
       [0.93448276, 0.06551724],
       ...,
       [0.0647482 , 0.9352518 ],
       [0.62730627, 0.37269373],
       [0.        , 1.        ]])</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Random-Patches-&amp;-Random-Subspaces">Random Patches &amp; Random Subspaces<a class="anchor-link" href="#Random-Patches-&amp;-Random-Subspaces">&#182;</a></h2><ul>
<li>We can sample features as well.</li>
<li>Sampling is controlled by two hyper-parameters: <code>max_features</code> &amp; <code>bootstrap_features</code>.</li>
<li>Thus, each predictor will be trained on a random feature sample.</li>
<li>This technique is especially useful when you're dealing with high-dimensional input as as imagery. </li>
<li>Sample both instances and features is called the random patches method.</li>
<li>Sampling only features is called the random subspaces method.</li>
<li>Sampling features results in a more predictor diversity.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Random-Forests">Random Forests<a class="anchor-link" href="#Random-Forests">&#182;</a></h2><ul>
<li>A random forest is an ensemble of decision trees.</li>
<li>Let's use its scikit-learn implementation:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">RandomForestClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnd_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">max_leaf_nodes</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnd_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(bootstrap=True, class_weight=None, criterion=&#39;gini&#39;,
            max_depth=None, max_features=&#39;auto&#39;, max_leaf_nodes=16,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=500, n_jobs=-1,
            oob_score=False, random_state=None, verbose=0,
            warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred_rf</span> <span class="o">=</span> <span class="n">rnd_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>The following <code>BaggingClassifier</code> is roughly equivalent to the previous <code>RandomForestClassifier</code>:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bag_clf</span> <span class="o">=</span> <span class="n">BaggingClassifier</span><span class="p">(</span>
    <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">splitter</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="n">max_leaf_nodes</span><span class="o">=</span><span class="mi">16</span><span class="p">),</span>
    <span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">max_samples</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">bootstrap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Extra-Trees">Extra-Trees<a class="anchor-link" href="#Extra-Trees">&#182;</a></h3><ul>
<li>When you are growing a tree in a random forest, only a subset of features are considered when splitting.</li>
<li>It's possible to make the trees more random by choosing different threshold of the features rather than searching for the best possible threshold.<ul>
<li>Such a model is called <strong>Extremely Randomized Trees Ensemble</strong>.</li>
</ul>
</li>
<li>When don't really know if an extremely randomized trees model will or will not outperform a classical random forest model.<ul>
<li>Generally, the only way to know is to try both and check their results using cross validation.</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Feature-Importance">Feature Importance<a class="anchor-link" href="#Feature-Importance">&#182;</a></h3><ul>
<li>Yet another great quality of random forests is that they make it so easy to measure the importance of each feature.</li>
<li>We measure the importance by averaging the reduced impurity of each node that uses a certain feature across all trees in the forest.<ul>
<li>More exactly it's a weighted average beacuse each node has a number of samples that is used to weight.</li>
</ul>
</li>
<li>Let's get feature importance using random forests on the iris dataset:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="k">import</span> <span class="n">load_iris</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnd_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnd_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">iris</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(bootstrap=True, class_weight=None, criterion=&#39;gini&#39;,
            max_depth=None, max_features=&#39;auto&#39;, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=500, n_jobs=-1,
            oob_score=False, random_state=None, verbose=0,
            warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iris</span><span class="p">[</span><span class="s1">&#39;feature_names&#39;</span><span class="p">],</span> <span class="n">rnd_clf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>sepal length (cm) 0.09511858189679075
sepal width (cm) 0.021817079798945354
petal length (cm) 0.46014470905510807
petal width (cm) 0.42291962924915605
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Let's plot pixel-wise MNIST feature importance:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="k">import</span> <span class="n">load_digits</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">digits</span> <span class="o">=</span> <span class="n">load_digits</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnd_clf</span> <span class="o">=</span> <span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rnd_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">digits</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">],</span> <span class="n">digits</span><span class="p">[</span><span class="s1">&#39;target&#39;</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>RandomForestClassifier(bootstrap=True, class_weight=None, criterion=&#39;gini&#39;,
            max_depth=None, max_features=&#39;auto&#39;, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, n_estimators=500, n_jobs=-1,
            oob_score=False, random_state=None, verbose=0,
            warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rnd_clf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Blues&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Random Forest are very handy to get a quick understanding of what features actually matter, particularly if you need to perform feature selection.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Boosting">Boosting<a class="anchor-link" href="#Boosting">&#182;</a></h2><ul>
<li>Boosting refers to any ensemble method that can combine several weak learners into a strong learner.</li>
<li>The general idea of most boosting methods is to train predictors sequentially, each trying to correct its predecessor. </li>
<li>There are many boosting methods available, but by far the most popular one is <strong>AdaBoost</strong> (Adaptive boosting) and <strong>gradient boosting</strong>.</li>
<li>Let's start with Adaboost:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width:50%;" file="static/imgs/adaboost.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">AdaBoostClassifier</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ada_clf</span> <span class="o">=</span> <span class="n">AdaBoostClassifier</span><span class="p">(</span><span class="n">base_estimator</span><span class="o">=</span><span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> 
                             <span class="n">n_estimators</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">algorithm</span><span class="o">=</span><span class="s1">&#39;SAMME.R&#39;</span><span class="p">,</span> 
                             <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">ada_clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>AdaBoostClassifier(algorithm=&#39;SAMME.R&#39;,
          base_estimator=DecisionTreeClassifier(class_weight=None, criterion=&#39;gini&#39;, max_depth=1,
            max_features=None, max_leaf_nodes=None,
            min_impurity_decrease=0.0, min_impurity_split=None,
            min_samples_leaf=1, min_samples_split=2,
            min_weight_fraction_leaf=0.0, presort=False, random_state=None,
            splitter=&#39;best&#39;),
          learning_rate=0.5, n_estimators=200, random_state=None)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">accuracy_score</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">ada_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">),</span> <span class="n">y_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.8272727272727273</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Gradient-Boosting">Gradient Boosting<a class="anchor-link" href="#Gradient-Boosting">&#182;</a></h3><ul>
<li>Just like Adaboost, Gradient Boosting works by sequentially adding predictors to an ensemble each one correcting its predecessor.</li>
<li>However, instead of tweaking the instance weights at every iteration like Adaboost does, this method tries to fit the new predictor to the <strong>residual errors</strong> made by the previous predictor.</li>
<li>Let's go through a simple regression example, First let's fit a decision tree regressor to a synthetically generated training set:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">stop</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span><span class="o">-</span><span class="mf">0.5</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">500</span><span class="p">)</span><span class="o">/</span><span class="mf">50.</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="kc">None</span><span class="p">]</span>  <span class="c1"># 1 feature</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="k">import</span> <span class="n">DecisionTreeRegressor</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_reg1</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_reg1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DecisionTreeRegressor(criterion=&#39;mse&#39;, max_depth=2, max_features=None,
           max_leaf_nodes=None, min_impurity_decrease=0.0,
           min_impurity_split=None, min_samples_leaf=1,
           min_samples_split=2, min_weight_fraction_leaf=0.0,
           presort=False, random_state=None, splitter=&#39;best&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Next, we'll train a second decision tree regressor on the errors made by the first tree:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y2</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">tree_reg1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_reg2</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_reg2</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DecisionTreeRegressor(criterion=&#39;mse&#39;, max_depth=2, max_features=None,
           max_leaf_nodes=None, min_impurity_decrease=0.0,
           min_impurity_split=None, min_samples_leaf=1,
           min_samples_split=2, min_weight_fraction_leaf=0.0,
           presort=False, random_state=None, splitter=&#39;best&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Now we train a third regressor on the errors made by the second regressor:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y3</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">tree_reg2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_reg3</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">tree_reg3</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>DecisionTreeRegressor(criterion=&#39;mse&#39;, max_depth=2, max_features=None,
           max_leaf_nodes=None, min_impurity_decrease=0.0,
           min_impurity_split=None, min_samples_leaf=1,
           min_samples_split=2, min_weight_fraction_leaf=0.0,
           presort=False, random_state=None, splitter=&#39;best&#39;)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Now we have an ensemble containing three trees. It can make predictions on a new instance simply by adding up the predictions of all the trees:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">tree</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="k">for</span> <span class="n">tree</span> <span class="ow">in</span> <span class="p">(</span><span class="n">tree_reg1</span><span class="p">,</span> <span class="n">tree_reg2</span><span class="p">,</span> <span class="n">tree_reg3</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width:66%;" file="static/imgs/boosting_ensembles.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="k">import</span> <span class="n">GradientBoostingRegressor</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gbrt</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gbrt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>GradientBoostingRegressor(alpha=0.9, criterion=&#39;friedman_mse&#39;, init=None,
             learning_rate=1.0, loss=&#39;ls&#39;, max_depth=2, max_features=None,
             max_leaf_nodes=None, min_impurity_decrease=0.0,
             min_impurity_split=None, min_samples_leaf=1,
             min_samples_split=2, min_weight_fraction_leaf=0.0,
             n_estimators=3, n_iter_no_change=None, presort=&#39;auto&#39;,
             random_state=None, subsample=1.0, tol=0.0001,
             validation_fraction=0.1, verbose=0, warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width:66%;" file="static/imgs/ensemble_overunderfit.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="k">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="k">import</span> <span class="n">mean_squared_error</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gbrt</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gbrt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>GradientBoostingRegressor(alpha=0.9, criterion=&#39;friedman_mse&#39;, init=None,
             learning_rate=0.1, loss=&#39;ls&#39;, max_depth=2, max_features=None,
             max_leaf_nodes=None, min_impurity_decrease=0.0,
             min_impurity_split=None, min_samples_leaf=1,
             min_samples_split=2, min_weight_fraction_leaf=0.0,
             n_estimators=120, n_iter_no_change=None, presort=&#39;auto&#39;,
             random_state=None, subsample=1.0, tol=0.0001,
             validation_fraction=0.1, verbose=0, warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">errors</span> <span class="o">=</span> <span class="p">[</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span> <span class="k">for</span> <span class="n">y_pred</span> <span class="ow">in</span> <span class="n">gbrt</span><span class="o">.</span><span class="n">staged_predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">bst_n_estimators</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">bst_n_estimators</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>67</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gbrt_best</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_estimators</span><span class="o">=</span><span class="n">bst_n_estimators</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gbrt_best</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>GradientBoostingRegressor(alpha=0.9, criterion=&#39;friedman_mse&#39;, init=None,
             learning_rate=0.1, loss=&#39;ls&#39;, max_depth=2, max_features=None,
             max_leaf_nodes=None, min_impurity_decrease=0.0,
             min_impurity_split=None, min_samples_leaf=1,
             min_samples_split=2, min_weight_fraction_leaf=0.0,
             n_estimators=67, n_iter_no_change=None, presort=&#39;auto&#39;,
             random_state=None, subsample=1.0, tol=0.0001,
             validation_fraction=0.1, verbose=0, warm_start=False)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width: 66%;" file="static/imgs/gradient_boosting_optimization.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gbrt</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">warm_start</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">min_val_error</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">)</span>
<span class="n">error_going_up</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">n_estimators</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">120</span><span class="p">):</span>
    <span class="n">gbrt</span><span class="o">.</span><span class="n">n_estimators</span> <span class="o">=</span> <span class="n">n_estimators</span>
    <span class="n">gbrt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">gbrt</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
    <span class="n">val_error</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">val_error</span> <span class="o">&lt;</span> <span class="n">min_val_error</span><span class="p">:</span>
        <span class="n">min_val_error</span> <span class="o">=</span> <span class="n">val_error</span>
        <span class="n">error_going_up</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">error_going_up</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">error_going_up</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
            <span class="k">break</span>  <span class="c1"># Early Stopping</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>It's worth noting that an optimized implementation of gradient boosting is available in the popular python library <strong><code>XGBoost</code></strong> (Stands for Extreme Gradient Boosting).</li>
<li>Let's try it out:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">xgboost</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xgb_reg</span> <span class="o">=</span> <span class="n">xgboost</span><span class="o">.</span><span class="n">XGBRegressor</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xgb_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[10:27:51] WARNING: src/objective/regression_obj.cu:152: reg:linear is now deprecated in favor of reg:squarederror.
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>XGBRegressor(base_score=0.5, booster=&#39;gbtree&#39;, colsample_bylevel=1,
       colsample_bynode=1, colsample_bytree=1, gamma=0,
       importance_type=&#39;gain&#39;, learning_rate=0.1, max_delta_step=0,
       max_depth=3, min_child_weight=1, missing=None, n_estimators=100,
       n_jobs=1, nthread=None, objective=&#39;reg:linear&#39;, random_state=0,
       reg_alpha=0, reg_lambda=1, scale_pos_weight=1, seed=None,
       silent=None, subsample=1, verbosity=1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>The library can take care of early stopping for you:</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">xgb_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">eval_set</span><span class="o">=</span><span class="p">[(</span><span class="n">X_val</span><span class="p">,</span> <span class="n">y_val</span><span class="p">)],</span> <span class="n">early_stopping_rounds</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[10:28:58] WARNING: src/objective/regression_obj.cu:152: reg:linear is now deprecated in favor of reg:squarederror.
[0]	validation_0-rmse:0.373822
Will train until validation_0-rmse hasn&#39;t improved in 2 rounds.
[1]	validation_0-rmse:0.337234
[2]	validation_0-rmse:0.304619
[3]	validation_0-rmse:0.275285
[4]	validation_0-rmse:0.248496
[5]	validation_0-rmse:0.224535
[6]	validation_0-rmse:0.202935
[7]	validation_0-rmse:0.183518
[8]	validation_0-rmse:0.165973
[9]	validation_0-rmse:0.150271
[10]	validation_0-rmse:0.136123
[11]	validation_0-rmse:0.123259
[12]	validation_0-rmse:0.11172
[13]	validation_0-rmse:0.101357
[14]	validation_0-rmse:0.092034
[15]	validation_0-rmse:0.083758
[16]	validation_0-rmse:0.076379
[17]	validation_0-rmse:0.069841
[18]	validation_0-rmse:0.063972
[19]	validation_0-rmse:0.058725
[20]	validation_0-rmse:0.054021
[21]	validation_0-rmse:0.049851
[22]	validation_0-rmse:0.046189
[23]	validation_0-rmse:0.042995
[24]	validation_0-rmse:0.040171
[25]	validation_0-rmse:0.03767
[26]	validation_0-rmse:0.035359
[27]	validation_0-rmse:0.033445
[28]	validation_0-rmse:0.031792
[29]	validation_0-rmse:0.030432
[30]	validation_0-rmse:0.029133
[31]	validation_0-rmse:0.028046
[32]	validation_0-rmse:0.027075
[33]	validation_0-rmse:0.026341
[34]	validation_0-rmse:0.025681
[35]	validation_0-rmse:0.025051
[36]	validation_0-rmse:0.024553
[37]	validation_0-rmse:0.024197
[38]	validation_0-rmse:0.023793
[39]	validation_0-rmse:0.023417
[40]	validation_0-rmse:0.023141
[41]	validation_0-rmse:0.022891
[42]	validation_0-rmse:0.022722
[43]	validation_0-rmse:0.0226
[44]	validation_0-rmse:0.022439
[45]	validation_0-rmse:0.022301
[46]	validation_0-rmse:0.02221
[47]	validation_0-rmse:0.022134
[48]	validation_0-rmse:0.022061
[49]	validation_0-rmse:0.02195
[50]	validation_0-rmse:0.02191
[51]	validation_0-rmse:0.021832
[52]	validation_0-rmse:0.021775
[53]	validation_0-rmse:0.021738
[54]	validation_0-rmse:0.021696
[55]	validation_0-rmse:0.021674
[56]	validation_0-rmse:0.021642
[57]	validation_0-rmse:0.021647
[58]	validation_0-rmse:0.021633
[59]	validation_0-rmse:0.021614
[60]	validation_0-rmse:0.02158
[61]	validation_0-rmse:0.021566
[62]	validation_0-rmse:0.021535
[63]	validation_0-rmse:0.021529
[64]	validation_0-rmse:0.021528
[65]	validation_0-rmse:0.021524
[66]	validation_0-rmse:0.021525
[67]	validation_0-rmse:0.021518
[68]	validation_0-rmse:0.021494
[69]	validation_0-rmse:0.021497
[70]	validation_0-rmse:0.021487
[71]	validation_0-rmse:0.021483
[72]	validation_0-rmse:0.021484
[73]	validation_0-rmse:0.021476
[74]	validation_0-rmse:0.021478
[75]	validation_0-rmse:0.021481
Stopping. Best iteration:
[73]	validation_0-rmse:0.021476

</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>XGBRegressor(base_score=0.5, booster=&#39;gbtree&#39;, colsample_bylevel=1,
       colsample_bynode=1, colsample_bytree=1, gamma=0,
       importance_type=&#39;gain&#39;, learning_rate=0.1, max_delta_step=0,
       max_depth=3, min_child_weight=1, missing=None, n_estimators=100,
       n_jobs=1, nthread=None, objective=&#39;reg:linear&#39;, random_state=0,
       reg_alpha=0, reg_lambda=1, scale_pos_weight=1, seed=None,
       silent=None, subsample=1, verbosity=1)</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">xgb_reg</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.00046120108202572606</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">y_val</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X_val</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">y_pred</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% include image.html style="width: 50%;" file="static/imgs/blender.png" %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Exercices">Exercices<a class="anchor-link" href="#Exercices">&#182;</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>1. If you have trained five different models on the exact same training data, and they all achieve 95% precision, is there any chance that you can combine these models to get better results? If so, How? If not, Why?</strong></p>
<ul>
<li>Yes, we can combine their predictions using:<ul>
<li>Classification<ul>
<li>hard voting (y_hat=mode(preds))</li>
<li>soft voting for classification (averaging estimated class probabilities and taking the class associated with the highest one).</li>
</ul>
</li>
<li>Regression<ul>
<li>Taking the mean of the predicted values from each model.</li>
</ul>
</li>
</ul>
</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>2. What is the difference between hard &amp; soft voting classifiers?</strong></p>
<ul>
<li>Hard voting: we take all of the predictions and output the mode (the most frequently predicted class).</li>
<li>Soft voting: we average all probabilities associated with each class and output the class with the highest averaged probability.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>3. Is it possible to speed up training of a bagging ensemble by distributing it across multiple servers? What about pasting ensembles? Boosting ensembles, random forests, stacking ensembles?</strong></p>
<ul>
<li>Bagging Ensemble (Bootstrap Aggregation  Sampling with replacement + feature subsetting): It is parallelizable.</li>
<li>Pasting Ensemble (Only difference  Sampling without replacement): It is parallelizable.</li>
<li>Boosting Ensemble (Trains predictors sequentially): Not parallelizable.</li>
<li>Random Forests: Parallelizable.</li>
<li>Stacking Ensemble: Stacking is partly parallelizable, we can train massive predictors in the first layer but we have to wait for the ith training phase to finish before training subsequent layers (and the final blender).</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>4. What is the benefit of out-of-bag evaluation?</strong></p>
<ul>
<li>We don't need a hold-out set and we evaluate each individual predictor on the fly and export and estimate of the overall performance of the ensemble model.</li>
</ul>

</div>
</div>
</div>
</div>
 

